<!-- NOTE: This document now includes auto-recording and export setup for TikTok-style ad generation -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ClipOpera Exportable Ad Generator</title>
  <style>
    body {
      margin: 0;
      background: black;
      font-family: 'Courier New', monospace;
      color: #33FF66;
      overflow: hidden;
    }
    canvas#captureCanvas {
      position: absolute;
      top: 0;
      left: 0;
      z-index: 50;
      display: none;
    }
    .crt-wrapper {
      perspective: 1000px;
    }
    .crt-curved {
      transform: rotateX(1deg);
    }
    svg {
      display: block;
      margin: 0 auto;
      width: 100vw;
      height: 100vh;
      filter: drop-shadow(0 0 6px #33FF66);
    }
    .frame {
      stroke: #CCCCCC;
      stroke-width: 20;
      fill: none;
      filter: url(#bevel);
    }
    .crt-effect {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: repeating-linear-gradient(to bottom, rgba(255,255,255,0.05) 0px, rgba(255,255,255,0.05) 1px, transparent 1px, transparent 4px);
      pointer-events: none;
      mix-blend-mode: overlay;
      z-index: 10;
    }
    #start-button {
      position: absolute;
      top: 90vh;
      left: 50%;
      transform: translateX(-50%);
      color: #33FF66;
      background: black;
      border: 2px solid #33FF66;
      font-size: 28px;
      padding: 10px 20px;
      cursor: pointer;
      animation: blink 1s step-start infinite;
      font-family: 'Courier New', monospace;
      z-index: 20;
    }
    #start-button:focus {
      outline: 3px dashed #FFCC00;
    }
    @keyframes blink { 50% { opacity: 0; } }
    #editor {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.8);
      padding: 10px;
      border: 1px solid #33FF66;
      color: #33FF66;
      font-family: monospace;
      z-index: 20;
    }
    #editor input, #editor select, #editor button {
      background: black;
      color: #33FF66;
      border: 1px solid #33FF66;
      font-family: monospace;
      margin: 2px;
    }
  </style>
</head>
<body>
<canvas id="captureCanvas" width="1080" height="1920"></canvas>
<!-- SVG container and retro UI -->
<div class="crt-wrapper">
  <div class="crt-curved">
    <svg id="main-svg" viewBox="0 0 1080 1920" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <filter id="bevel">
          <feGaussianBlur in="SourceAlpha" stdDeviation="3" result="blur"/>
          <feOffset in="blur" dx="4" dy="4" result="offsetBlur"/>
          <feMerge>
            <feMergeNode in="offsetBlur"/>
            <feMergeNode in="SourceGraphic"/>
          </feMerge>
        </filter>
      </defs>
      <rect class="frame" x="10" y="10" width="1060" height="1900" />
      <rect width="100%" height="100%" fill="black" />
      <text x="50%" y="15%" font-size="18" fill="#00FF00" text-anchor="middle">____ _ _       ____</text>
      <text x="50%" y="18%" font-size="18" fill="#00FF00" text-anchor="middle"> / ___| (_)_ __ |  _ \ ___  ___  _ __</text>
      <text x="50%" y="21%" font-size="18" fill="#00FF00" text-anchor="middle">| |   | | | '_ \| |_) / _ \/ _ \| '_ \</text>
      <text x="50%" y="24%" font-size="18" fill="#00FF00" text-anchor="middle">| |___| | | |_) |  __/  __/ (_) | | | |</text>
      <text x="50%" y="27%" font-size="18" fill="#00FF00" text-anchor="middle"> \____|_|_| .__/|_|   \___|\___/|_| |_|</text>
      <text x="50%" y="30%" font-size="18" fill="#00FF00" text-anchor="middle">          |_|</text>
      <text id="logo" x="50%" y="40%" font-size="80" fill="#33FF66" text-anchor="middle" dominant-baseline="middle">CLIPOPERA</text>
      <text id="subtitle" x="50%" y="50%" font-size="32" fill="#AAAAAA" text-anchor="middle">Your Retro Ad Engine</text>
      <text id="tagline" x="50%" y="60%" font-size="24" fill="#888888" text-anchor="middle">Pixel Ads | 8-bit Promos | CRT Cool</text>
      <animate xlink:href="#logo" attributeName="font-size" values="80;100;80" dur="1.5s" repeatCount="indefinite" />
    </svg>
  </div>
</div>
<button id="start-button" onclick="startExport()">â–¶ EXPORT AD</button>
<div class="crt-effect"></div>
<div id="editor">
  Title: <input type="text" id="input-title" value="CLIPOPERA"><br>
  Subtitle: <input type="text" id="input-sub" value="Your Retro Ad Engine"><br>
  Tagline: <input type="text" id="input-tag" value="Pixel Ads | 8-bit Promos | CRT Cool"><br>
  Voice: <select id="voice-selector"></select><br>
  Theme: <select id="theme-selector" onchange="changeTheme()">
    <option value="default">Default</option>
    <option value="cyber">Cyber Green</option>
    <option value="neon">Neon Purple</option>
    <option value="blue">Tech Blue</option>
  </select><br>
  <button onclick="updateText()">Update</button>
  <button onclick="speakText()">Play Voice</button>
</div>
<script>
  let voices = [];
  function populateVoices() {
    voices = window.speechSynthesis.getVoices();
    const selector = document.getElementById('voice-selector');
    selector.innerHTML = '';
    voices.forEach((voice, i) => {
      const option = document.createElement('option');
      option.value = i;
      option.textContent = voice.name + ' (' + voice.lang + ')';
      selector.appendChild(option);
    });
  }
  window.speechSynthesis.onvoiceschanged = populateVoices;

  function speakText() {
    const text = `${document.getElementById('logo').textContent}. ${document.getElementById('subtitle').textContent}. ${document.getElementById('tagline').textContent}`;
    const message = new SpeechSynthesisUtterance(text);
    const selectedVoice = document.getElementById('voice-selector').value;
    if (voices[selectedVoice]) message.voice = voices[selectedVoice];
    message.rate = 0.85;
    message.pitch = 0.9;
    window.speechSynthesis.speak(message);
  }

  function updateText() {
    document.getElementById('logo').textContent = document.getElementById('input-title').value;
    document.getElementById('subtitle').textContent = document.getElementById('input-sub').value;
    document.getElementById('tagline').textContent = document.getElementById('input-tag').value;
  }

  function changeTheme() {
    const theme = document.getElementById('theme-selector').value;
    const logo = document.getElementById('logo');
    const subtitle = document.getElementById('subtitle');
    const tagline = document.getElementById('tagline');
    switch (theme) {
      case 'cyber': logo.setAttribute('fill', '#39FF14'); subtitle.setAttribute('fill', '#33FF66'); tagline.setAttribute('fill', '#66FF99'); break;
      case 'neon': logo.setAttribute('fill', '#BB86FC'); subtitle.setAttribute('fill', '#CCCCFF'); tagline.setAttribute('fill', '#FFBBFF'); break;
      case 'blue': logo.setAttribute('fill', '#33C1FF'); subtitle.setAttribute('fill', '#99D9FF'); tagline.setAttribute('fill', '#66B2FF'); break;
      default: logo.setAttribute('fill', '#33FF66'); subtitle.setAttribute('fill', '#AAAAAA'); tagline.setAttribute('fill', '#888888');
    }
  }

  function startExport() {
    const canvas = document.getElementById('captureCanvas');
    const ctx = canvas.getContext('2d');
    const svg = document.getElementById('main-svg');
    const data = new XMLSerializer().serializeToString(svg);
    const img = new Image();
    const svgBlob = new Blob([data], {type: 'image/svg+xml;charset=utf-8'});
    const url = URL.createObjectURL(svgBlob);
    img.onload = () => {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.drawImage(img, 0, 0);
      const link = document.createElement('a');
      link.download = 'clipopera_ad.png';
      link.href = canvas.toDataURL('image/png');
      link.click();
      URL.revokeObjectURL(url);
    };
    img.src = url;
  }
</script>
</body>
</html>
